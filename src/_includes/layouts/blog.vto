<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }} - Marwan Ayman Shawky</title>
  <meta name="description" content="{{ description }}">
  
  <!-- SEO Meta Tags -->
  <meta property="og:title" content="{{ title }}">
  <meta property="og:description" content="{{ description }}">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://maroayman.vercel.app{{ url }}">
  <meta property="article:published_time" content="{{ date |> date('DATE') }}">
  {{ if cover }}
  <meta property="og:image" content="{{ cover }}">
  {{ /if }}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ title }}">
  <meta name="twitter:description" content="{{ description }}">
  {{ if cover }}
  <meta name="twitter:image" content="{{ cover }}">
  {{ /if }}
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "{{ title }}",
    "description": "{{ description }}",
    "url": "https://maroayman.vercel.app{{ url }}",
    "datePublished": "{{ date |> date('DATE') }}",
    "dateModified": "{{ date |> date('DATE') }}",
    {{ if cover }}
    "image": "{{ cover }}",
    {{ /if }}
    "author": {
      "@type": "Person",
      "name": "Marwan Ayman Shawky",
      "url": "https://maroayman.vercel.app"
    },
    "publisher": {
      "@type": "Person",
      "name": "Marwan Ayman Shawky",
      "url": "https://maroayman.vercel.app"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://maroayman.vercel.app{{ url }}"
    }
    {{ if tags }},
    "keywords": "{{ tags.join(', ') }}"
    {{ /if }}
  }
  </script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="/styles/main.css">
  
  <!-- Apply theme immediately to prevent flash -->
  <script>
    (function() {
      const theme = localStorage.getItem('theme') || 'light';
      if (theme === 'dark') {
        document.documentElement.classList.add('dark-mode');
      }
    })();
  </script>
  
  <!-- Speculation Rules for faster navigation (Chrome/Edge 109+) -->
  <script type="speculationrules">
    {
      "prerender": [
        {
          "source": "document",
          "where": {
            "and": [
              { "href_matches": "/*" },
              { "not": { "href_matches": "/*\\?*" } },
              { "not": { "selector_matches": "[rel~=external]" } },
              { "not": { "selector_matches": "[target=_blank]" } }
            ]
          },
          "eagerness": "moderate"
        }
      ],
      "prefetch": [
        {
          "source": "document",
          "where": {
            "href_matches": "/*"
          },
          "eagerness": "moderate"
        }
      ]
    }
  </script>
  
  <!-- Fallback to instant.page for browsers without Speculation Rules API -->
  <script type="module">
    if (!HTMLScriptElement.supports?.('speculationrules')) {
      import('https://instant.page/5.2.0');
    }
  </script>
</head>
<body>
  <!-- Reading Progress Bar -->
  <div class="reading-progress" id="readingProgress"></div>
  
  <!-- Theme Toggle -->
  <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
    <svg class="sun-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
    </svg>
    <svg class="moon-icon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
    </svg>
  </button>
  
  <!-- Back to Top Button -->
  <button class="back-to-top" id="backToTop" aria-label="Back to top">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
    </svg>
  </button>
  
  <!-- Image Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <button class="lightbox-close" id="lightboxClose" aria-label="Close lightbox">&times;</button>
    <button class="lightbox-nav lightbox-prev" id="lightboxPrev" aria-label="Previous image">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
    <button class="lightbox-nav lightbox-next" id="lightboxNext" aria-label="Next image">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>
    <div class="lightbox-content">
      <img class="lightbox-image" id="lightboxImage" src="" alt="">
      <p class="lightbox-caption" id="lightboxCaption"></p>
    </div>
  </div>
  
  <!-- Header -->
  <header>
    <div class="container">
      <h1>Marwan Ayman Shawky</h1>
      <p style="color: var(--color-text-secondary); margin-bottom: 2rem;">Cloud & DevOps Engineer</p>
    </div>
  </header>
  
  <!-- Main Content -->
  <main>
    <div class="container">
      <section class="section">
        <p class="back-link">
          <a href="/blog">← Back to Blog</a>
        </p>
        
        <article class="blog-article">
          {{ if cover }}
          <figure class="blog-cover" data-lightbox>
            <img src="{{ cover }}" alt="{{ title }}" loading="lazy">
          </figure>
          {{ /if }}
          
          <header class="blog-header">
            <h1 class="blog-title">{{ title }}</h1>
            <div class="blog-meta">
              <time datetime="{{ date |> date('DATE') }}">{{ date |> date('HUMAN_DATE') }}</time>
              <span>·</span>
              <span id="readingTime">Calculating...</span>
              <span>·</span>
              <span id="wordCount"></span>
            </div>
            {{ if tags }}
            <div class="blog-tags">
              {{ for tag of tags }}
              <span class="tech-tag">{{ tag }}</span>
              {{ /for }}
            </div>
            {{ /if }}
            
            <!-- Social Share Buttons -->
            <div class="social-share">
              <span class="share-label">Share:</span>
              <button class="share-btn" id="shareTwitter" aria-label="Share on Twitter" title="Share on Twitter">
                <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </button>
              <button class="share-btn" id="shareLinkedIn" aria-label="Share on LinkedIn" title="Share on LinkedIn">
                <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </button>
              <button class="share-btn" id="shareNative" aria-label="Share" title="Share">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                  <circle cx="18" cy="5" r="3"/>
                  <circle cx="6" cy="12" r="3"/>
                  <circle cx="18" cy="19" r="3"/>
                  <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                  <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                </svg>
              </button>
            </div>
          </header>
          
          <div class="blog-content">
            {{ content }}
          </div>
          
          <!-- Social Share (Bottom) -->
          <div class="social-share social-share-bottom">
            <span class="share-label">Enjoyed this article? Share it:</span>
            <div class="share-buttons">
              <button class="share-btn share-btn-lg" id="shareTwitterBottom" aria-label="Share on Twitter">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
                <span>Twitter</span>
              </button>
              <button class="share-btn share-btn-lg" id="shareLinkedInBottom" aria-label="Share on LinkedIn">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
                <span>LinkedIn</span>
              </button>
              <button class="share-btn share-btn-lg" id="shareNativeBottom" aria-label="Share">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                  <circle cx="18" cy="5" r="3"/>
                  <circle cx="6" cy="12" r="3"/>
                  <circle cx="18" cy="19" r="3"/>
                  <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                  <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                </svg>
                <span>More</span>
              </button>
            </div>
          </div>
        </article>
        
        <!-- Related Posts -->
        {{ if tags }}
        {{ set relatedPosts = search.pages("type=post", "date=desc").filter(p => p.url !== url && p.tags && p.tags.some(t => tags.includes(t))).slice(0, 3) }}
        {{ if relatedPosts.length > 0 }}
        <section class="related-posts">
          <h3 class="related-posts-title">Related Articles</h3>
          <div class="related-posts-grid">
            {{ for post of relatedPosts }}
            <a href="{{ post.url }}" class="related-post-card">
              {{ if post.cover }}
              <div class="related-post-cover">
                <img src="{{ post.cover }}" alt="{{ post.title }}" loading="lazy">
              </div>
              {{ /if }}
              <div class="related-post-content">
                <h4>{{ post.title }}</h4>
                <div class="related-post-meta">
                  <time>{{ post.date |> date('HUMAN_DATE') }}</time>
                </div>
              </div>
            </a>
            {{ /for }}
          </div>
        </section>
        {{ /if }}
        {{ /if }}
      </section>
    </div>
  </main>
  
  <!-- Footer -->
  <footer>
    <div class="container">
      <p>© <span id="year"></span> Marwan Ayman Shawky</p>
    </div>
  </footer>
  
  <script>
    // ========== THEME TOGGLE ==========
    (function() {
      const themeToggle = document.getElementById('themeToggle');
      const sunIcon = document.querySelector('.sun-icon');
      const moonIcon = document.querySelector('.moon-icon');
      
      if (!themeToggle || !sunIcon || !moonIcon) {
        console.warn('Theme toggle elements not found');
        return;
      }
      
      function applyTheme(theme) {
        const isDark = theme === 'dark';
        document.body.classList.toggle('dark-mode', isDark);
        document.documentElement.classList.toggle('dark-mode', isDark);
        sunIcon.style.display = isDark ? 'none' : 'block';
        moonIcon.style.display = isDark ? 'block' : 'none';
      }
      
      // Apply current theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      applyTheme(savedTheme);
      
      // Toggle handler
      themeToggle.addEventListener('click', function() {
        const newTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
        localStorage.setItem('theme', newTheme);
        applyTheme(newTheme);
      });
    })();
    
    // Year
    const yearEl = document.getElementById('year');
    if (yearEl) yearEl.textContent = new Date().getFullYear();
    
    // ========== READING PROGRESS BAR ==========
    (function() {
      const progressBar = document.getElementById('readingProgress');
      const article = document.querySelector('.blog-content');
      
      if (!progressBar || !article) {
        console.warn('Progress bar or article not found');
        return;
      }
      
      function updateProgress() {
        const articleRect = article.getBoundingClientRect();
        const articleTop = window.scrollY + articleRect.top;
        const articleHeight = article.offsetHeight;
        const windowHeight = window.innerHeight;
        const scrolled = window.scrollY - articleTop + windowHeight * 0.3;
        const progress = Math.min(100, Math.max(0, (scrolled / articleHeight) * 100));
        progressBar.style.width = progress + '%';
      }
      
      window.addEventListener('scroll', updateProgress, { passive: true });
      updateProgress(); // Initial call
    })();
    
    // ========== DYNAMIC READING TIME & WORD COUNT ==========
    (function() {
      const blogContent = document.querySelector('.blog-content');
      const readingTimeEl = document.getElementById('readingTime');
      const wordCountEl = document.getElementById('wordCount');
      
      if (!blogContent) return;
      
      const text = blogContent.innerText || blogContent.textContent || '';
      const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
      const readingTime = Math.max(1, Math.ceil(words / 200)); // 200 words per minute
      
      if (readingTimeEl) {
        readingTimeEl.textContent = readingTime + ' min read';
      }
      if (wordCountEl) {
        wordCountEl.textContent = words.toLocaleString() + ' words';
      }
    })();
    
    // ========== COPY CODE BUTTON ==========
    document.querySelectorAll('.blog-content pre').forEach(pre => {
      const wrapper = document.createElement('div');
      wrapper.className = 'code-block-wrapper';
      pre.parentNode.insertBefore(wrapper, pre);
      wrapper.appendChild(pre);
      
      const copyBtn = document.createElement('button');
      copyBtn.className = 'copy-code-btn';
      copyBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg><span>Copy</span>';
      copyBtn.setAttribute('aria-label', 'Copy code');
      wrapper.appendChild(copyBtn);
      
      copyBtn.addEventListener('click', async () => {
        const code = pre.querySelector('code') || pre;
        const text = code.innerText;
        
        try {
          await navigator.clipboard.writeText(text);
          copyBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="20 6 9 17 4 12"/></svg><span>Copied!</span>';
          copyBtn.classList.add('copied');
          
          setTimeout(() => {
            copyBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg><span>Copy</span>';
            copyBtn.classList.remove('copied');
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
        }
      });
    });
    
    // ========== SOCIAL SHARE BUTTONS ==========
    const pageUrl = encodeURIComponent(window.location.href);
    const pageTitle = encodeURIComponent(document.title);
    
    function shareTwitter() {
      window.open(`https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`, '_blank', 'width=550,height=420');
    }
    
    function shareLinkedIn() {
      window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`, '_blank', 'width=550,height=420');
    }
    
    function shareReddit() {
      window.open(`https://www.reddit.com/submit?url=${pageUrl}&title=${pageTitle}`, '_blank', 'width=550,height=420');
    }
    
    function shareHackerNews() {
      window.open(`https://news.ycombinator.com/submitlink?u=${pageUrl}&t=${pageTitle}`, '_blank', 'width=550,height=420');
    }
    
    function shareEmail() {
      window.location.href = `mailto:?subject=${pageTitle}&body=Check out this article: ${pageUrl}`;
    }
    
    async function shareNative(btn) {
      if (navigator.share) {
        try {
          await navigator.share({
            title: document.title,
            text: document.querySelector('meta[name="description"]')?.content || '',
            url: window.location.href
          });
        } catch (err) {
          if (err.name !== 'AbortError') {
            console.error('Share failed:', err);
          }
        }
      } else {
        // Fallback to copy link on desktop
        copyLink(btn);
      }
    }
    
    async function copyLink(btn) {
      try {
        await navigator.clipboard.writeText(window.location.href);
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18"><polyline points="20 6 9 17 4 12"/></svg>';
        btn.classList.add('copied');
        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.classList.remove('copied');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    }
    
    // Header share buttons
    document.getElementById('shareTwitter')?.addEventListener('click', shareTwitter);
    document.getElementById('shareLinkedIn')?.addEventListener('click', shareLinkedIn);
    document.getElementById('shareNative')?.addEventListener('click', function() { shareNative(this); });
    
    // Bottom share buttons
    document.getElementById('shareTwitterBottom')?.addEventListener('click', shareTwitter);
    document.getElementById('shareLinkedInBottom')?.addEventListener('click', shareLinkedIn);
    document.getElementById('shareNativeBottom')?.addEventListener('click', function() { shareNative(this); });
    
    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // Security: Ensure rel="noopener noreferrer" for all target="_blank" links
    document.querySelectorAll('a[target="_blank"]').forEach(link => {
      if (!link.rel.includes('noopener')) link.rel += (link.rel ? ' ' : '') + 'noopener';
      if (!link.rel.includes('noreferrer')) link.rel += (link.rel ? ' ' : '') + 'noreferrer';
    });
    
    // Back to Top
    const backToTop = document.getElementById('backToTop');
    
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });
    
    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    // Image Lightbox
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightboxImage');
    const lightboxCaption = document.getElementById('lightboxCaption');
    const lightboxClose = document.getElementById('lightboxClose');
    const lightboxPrev = document.getElementById('lightboxPrev');
    const lightboxNext = document.getElementById('lightboxNext');
    
    // Get all images in the article
    const articleImages = document.querySelectorAll('.blog-content img, .blog-cover img');
    let currentImageIndex = 0;
    const imageList = Array.from(articleImages);
    
    // Make images clickable
    articleImages.forEach((img, index) => {
      img.style.cursor = 'pointer';
      img.addEventListener('click', () => {
        openLightbox(index);
      });
    });
    
    function openLightbox(index) {
      currentImageIndex = index;
      const img = imageList[index];
      lightboxImage.src = img.src;
      lightboxCaption.textContent = img.alt || '';
      lightbox.classList.add('active');
      lightbox.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      updateNavButtons();
    }
    
    function closeLightbox() {
      lightbox.classList.remove('active');
      lightbox.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }
    
    function showPrevImage() {
      if (currentImageIndex > 0) {
        openLightbox(currentImageIndex - 1);
      }
    }
    
    function showNextImage() {
      if (currentImageIndex < imageList.length - 1) {
        openLightbox(currentImageIndex + 1);
      }
    }
    
    function updateNavButtons() {
      lightboxPrev.style.display = currentImageIndex > 0 ? 'flex' : 'none';
      lightboxNext.style.display = currentImageIndex < imageList.length - 1 ? 'flex' : 'none';
    }
    
    lightboxClose.addEventListener('click', closeLightbox);
    lightboxPrev.addEventListener('click', showPrevImage);
    lightboxNext.addEventListener('click', showNextImage);
    
    // Close on background click
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        closeLightbox();
      }
    });
    
    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (!lightbox.classList.contains('active')) return;
      
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowLeft') showPrevImage();
      if (e.key === 'ArrowRight') showNextImage();
    });
    
    // Register Service Worker with update handling
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const registration = await navigator.serviceWorker.register('/sw.js');
          console.log('ServiceWorker registered:', registration.scope);
          
          // Check for updates
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            if (newWorker) {
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New content available, show refresh prompt
                  if (confirm('New version available! Reload to update?')) {
                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                    window.location.reload();
                  }
                }
              });
            }
          });
        } catch (error) {
          console.log('ServiceWorker registration failed:', error);
        }
      });
    }
    
    // Track reading history
    (function() {
      const articleUrl = '{{ url }}';
      const articleData = {
        url: articleUrl,
        title: `{{ title }}`,
        readAt: new Date().toISOString()
      };
      
      try {
        const history = JSON.parse(localStorage.getItem('blog_reading_history') || '[]');
        const existingIndex = history.findIndex(item => item.url === articleUrl);
        
        if (existingIndex > -1) {
          history.splice(existingIndex, 1);
        }
        
        history.unshift(articleData);
        
        // Keep only last 50 articles
        if (history.length > 50) {
          history.pop();
        }
        
        localStorage.setItem('blog_reading_history', JSON.stringify(history));
      } catch (e) {
        console.warn('Could not save reading history:', e);
      }
    })();
  </script>
</body>
</html>
